(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-335fe83b"],{"715c":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"my-3",attrs:{id:"wrap"}},[s("div",{staticClass:"row my-4"},[s("div",{staticClass:"mb-0 d-flex align-items-center"},[s("h4",{staticClass:"text-left"},[s("router-link",{attrs:{to:{name:"organization"},tag:"a","active-class":"active"}},[s("a",[t._v(t._s(t.orgName))])]),t._v("\n        / "),s("router-link",{attrs:{to:{name:"project"},tag:"a","active-class":"active"}},[s("a",[t._v(t._s(t.proName))])])],1)]),t._m(0)]),s("ul",{staticClass:"nav nav-tabs"},[t._m(1),s("router-link",{staticClass:"nav-item",attrs:{to:{name:"project"},tag:"li","active-class":"active"}},[s("a",{staticClass:"nav-link active"},[t._v("問題 "),s("span",{staticClass:"ml-2 badge badge-secondary"},[t._v(t._s(t.issues.length))])])]),t._m(2),t._m(3),t._m(4),t._m(5),t._m(6)],1),s("div",{staticClass:"row my-4 d-flex justify-content-between"},[s("div",{staticClass:"btn-group",attrs:{role:"group","aria-label":"Basic example"}},[s("router-link",{staticClass:"btn btn-outline-secondary",attrs:{to:{name:"label",params:{proId:t.proId,issues:t.issues}},tag:"button","active-class":"active"}},[t._v("\n        標籤\n      ")]),s("router-link",{staticClass:"btn btn-outline-secondary",attrs:{to:{name:"milestone",params:{proId:t.proId}},tag:"button","active-class":"active"}},[t._v("\n        里程碑\n      ")])],1)]),s("hr"),s("div",{staticClass:"row"},[s("div",{staticClass:"col-9"},[s("div",{staticClass:"row"},[t.avatarHash.length>0?s("img",{staticClass:"rounded",staticStyle:{width:"50px",height:"50px"},attrs:{src:"https://www.gravatar.com/avatar/"+t.avatarHash,alt:""}}):t._e(),s("form",{staticClass:"rounded ml-3 col-11",staticStyle:{border:"1px solid rgba(34,36,38,.15)"}},[s("div",{staticClass:"form-group text-left"},[s("label",{attrs:{for:"title"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitIssue(e)}}}),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.title,expression:"title",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{placeholder:"標題",id:"title"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),t._m(7),s("div",{staticClass:"form-group text-left"},[s("label",{attrs:{for:"content"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitIssue(e)}}}),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],staticClass:"form-control",attrs:{id:"content",rows:"10"},domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}})]),s("div",{staticClass:"py-5 d-flex justify-content-center border border-primary"},[t._v("拖放檔案或是點擊此處上傳")]),s("button",{staticClass:"d-block ml-auto my-3 btn btn-success",on:{click:function(e){return e.preventDefault(),t.submitIssue(e)}}},[t._v("建立問題")])])])]),t._m(8)])])},n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ml-auto"},[s("div",{staticClass:"pr-3 btn-group btn-group-toggle",attrs:{"data-toggle":"buttons"}},[s("label",{staticClass:"border border-dark btn"},[s("input",{attrs:{type:"radio",name:"options",id:"option1",autocomplete:"off",checked:""}}),t._v(" 取消關注\n        ")]),s("label",{staticClass:"border border-dark btn"},[s("input",{attrs:{type:"radio",name:"options",id:"option2",autocomplete:"off"}}),t._v(" 8\n        ")])]),s("div",{staticClass:"pr-3 btn-group btn-group-toggle",attrs:{"data-toggle":"buttons"}},[s("label",{staticClass:"border border-dark btn"},[s("input",{attrs:{type:"radio",name:"options",id:"option1",autocomplete:"off",checked:""}}),t._v(" 收藏\n        ")]),s("label",{staticClass:"border border-dark btn"},[s("input",{attrs:{type:"radio",name:"options",id:"option2",autocomplete:"off"}}),t._v(" 0\n        ")])]),s("div",{staticClass:"pr-3 btn-group btn-group-toggle",attrs:{"data-toggle":"buttons"}},[s("label",{staticClass:"border border-dark btn"},[s("input",{attrs:{type:"radio",name:"options",id:"option1",autocomplete:"off",checked:""}}),t._v(" 複製\n        ")]),s("label",{staticClass:"border border-dark btn"},[s("input",{attrs:{type:"radio",name:"options",id:"option2",autocomplete:"off"}}),t._v(" 0\n        ")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("li",{staticClass:"nav-item"},[s("a",{staticClass:"nav-link",attrs:{href:"#"}},[t._v("程式碼")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("li",{staticClass:"nav-item"},[s("a",{staticClass:"nav-link",attrs:{href:"#"}},[t._v("合併請求"),s("span",{staticClass:"ml-2 badge badge-secondary"},[t._v("0")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("li",{staticClass:"nav-item"},[s("a",{staticClass:"nav-link",attrs:{href:"#"}},[t._v("版本發佈"),s("span",{staticClass:"ml-2 badge badge-secondary"},[t._v("0")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("li",{staticClass:"nav-item"},[s("a",{staticClass:"nav-link",attrs:{href:"#"}},[t._v("Wiki")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("li",{staticClass:"nav-item"},[s("a",{staticClass:"nav-link",attrs:{href:"#"}},[t._v("活動")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("li",{staticClass:"ml-auto nav-item"},[s("a",{staticClass:"nav-link",attrs:{href:"#"}},[t._v("儲存庫設定")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",{staticClass:"nav nav-tabs"},[s("li",{staticClass:"nav-item"},[s("a",{staticClass:"nav-link active",attrs:{href:"#"}},[t._v("Write")])]),s("li",{staticClass:"nav-item"},[s("a",{staticClass:"nav-link",attrs:{href:"#"}},[t._v("Preview")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"col-3"},[s("ul",{staticClass:"text-left list-group list-group-flush",staticStyle:{border:"1px solid rgba(34,36,38,.15)"}},[s("li",{staticClass:"list-group-item"},[s("input",{staticClass:"form-control",attrs:{type:"text",placeholder:"未指定分支或標籤"}})]),s("li",{staticClass:"pb-5 list-group-item"},[t._v("標籤")]),s("li",{staticClass:"pb-5 list-group-item"},[t._v("里程碑")]),s("li",{staticClass:"pb-5 list-group-item"},[t._v("指派成員")])])])}],i=(s("7514"),s("bf48")),r=s.n(i),o={name:"project",components:{AddIssue:d},data:function(){return{proName:"",issues:[],issueAdding:!1,title:"",content:"",username:this.$store.state.user.username,labels:[],checked:[],opened:[],closed:[],showOpened:!0,milestones:[],users:[],orgName:"",orgId:"",mileTitle:"",avatarHash:""}},computed:{proId:function(){return this.$route.params.proId},userId:function(){return this.$store.state.user.input.userId},checking:function(){var t=this;if(0===t.checked.length)return!1}},created:function(){var t=this,e=r.a.Object.extend("Account"),s=new r.a.Query(e);s.get(t.userId).then(function(e){t.avatarHash=e.get("avatarHash")},function(t){})},mounted:function(){var t=this;t.showUser(),t.showProName(),t.showIssue(),t.showLabel(),t.showMilestone()},methods:{showUser:function(){var t=this,e=r.a.Object.extend("Project"),s=new r.a.Query(e),a=[];s.get(t.proId).then(function(e){var s=e.get("orgId"),n=r.a.Object.extend("Organization"),i=new r.a.Query(n);t.orgId=s,i.get(s).then(function(t){for(var e=t.get("memberId"),s=function(t){var s={},n=e[t],i=r.a.Object.extend("Account"),o=new r.a.Query(i);o.get(n).then(function(t){s.name=t.get("username"),s.assigneeId=n,s.avatarHash=t.get("avatarHash"),s.email=t.get("email"),a.push(s)})},n=0;n<e.length;n++)s(n)}),t.users=a},function(t){})},showProName:function(){var t=this,e=t.$route.params.proId,s=r.a.Object.extend("Project"),a=new r.a.Query(s);a.get(e).then(function(e){t.proName=e.get("name"),t.orgName=e.get("orgName")})},showIssue:function(){var t=this,e=r.a.Object.extend("Issue"),s=new r.a.Query(e);s.equalTo("proId",t.proId);var a=[],n=[],i=[];s.find().then(function(t){for(var e=function(e){var s={},o=t[e];s.name=o.get("name"),s.issueId=o.id,s.creator=o.get("creator"),s.issueOpened=o.get("issueOpened"),s.avatarHash=o.get("avatarHash"),s.assigneeId=o.get("assigneeId"),s.mileTitle=o.get("mileTitle");var c=[],l=r.a.Object.extend("Label"),u=new r.a.Query(l);u.equalTo("issueId",o.id),u.find().then(function(t){for(var e=0;e<t.length;e++){var s=t[e];c.push(s.get("title"))}}),s.labels=c,a.push(s),!0===s.issueOpened?n.push(s):!1===s.issueOpened&&i.push(s)},s=0;s<t.length;s++)e(s)}),t.issues=a,t.opened=n,t.closed=i},showLabel:function(){var t=this,e=r.a.Object.extend("Label"),s=new r.a.Query(e),a=[];s.equalTo("proId",t.proId),s.find().then(function(t){for(var e=0;e<t.length;e++){var s={},n=t[e];s.labelId=n.id,s.title=n.get("title"),s.labelDesc=n.get("labelDesc"),s.issueId=n.get("issueId"),a.push(s)}},function(t){}),t.labels=a},addIssue:function(){this.issueAdding=!0},submitIssue:function(){var t=this,e=r.a.Object.extend("Issue"),s=new e;new r.a.Query(e);s.set("name",t.title),s.set("content",t.content),s.set("creator",t.$store.state.user.username),s.set("creatorId",t.$store.state.user.input.userId),s.set("issueOpened",!0),s.set("milestone",""),s.set("mileTitle",""),s.set("avatarHash",[]),s.set("orgId",t.orgId),s.set("proId",t.proId),s.set("orgName",t.orgName),s.set("proName",t.proName),s.save().then(function(e){t.title="",t.content="",t.showIssue(),t.issueAdding=!1,t.$router.push({name:"project"})},function(t){alert("Failed to create new object, with error code: "+t.message)})},cancel:function(){this.issueAdding=!1,this.title="",this.content=""},closeIssue:function(){for(var t=this,e=r.a.Object.extend("Issue"),s=0;s<t.checked.length;s++){var a=new r.a.Query(e);a.get(t.checked[s]).then(function(e){e.set("issueOpened",!1),e.save().then(function(){t.showIssue()})},function(t){})}t.checked=[]},reopenIssue:function(){for(var t=this,e=r.a.Object.extend("Issue"),s=0;s<t.checked.length;s++){var a=new r.a.Query(e);a.get(t.checked[s]).then(function(e){e.set("issueOpened",!0),e.save().then(function(){return t.showIssue()})},function(t){})}t.checked=[]},showMilestone:function(){var t=this,e=r.a.Object.extend("Milestone"),s=new r.a.Query(e),a=[];s.equalTo("proId",t.proId),s.find().then(function(t){for(var e=0;e<t.length;e++){var s={},n=t[e];s.mileId=n.id,s.title=n.get("title"),a.push(s)}}),t.milestones=a},addLabelTo:function(t){var e=this,s=r.a.Object.extend("Label"),a=new r.a.Query(s);a.get(t).then(function(t){for(var s=0;s<e.checked.length;s++){var a=e.checked[s];t.addUnique("issueId",a),console.log(a)}t.save().then(function(t){e.showIssue()})},function(t){})},addIssueTo:function(t,e){for(var s=this,a=r.a.Object.extend("Issue"),n=0;n<s.checked.length;n++){var i=new r.a.Query(a);i.get(s.checked[n]).then(function(a){a.set("milestone",t),a.set("mileTitle",e),a.save().then(function(t){s.showIssue(),s.checked=[]});var n=r.a.Object.extend("Milestone"),i=new r.a.Query(n);i.get(t).then(function(t){return t.set("proId",s.proId),t.save()},function(t){})},function(t){})}},assignTo:function(t,e){var s=this,a=r.a.Object.extend("Issue"),n=new r.a.Query(a);n.containedIn("objectId",s.checked),n.find().then(function(n){for(var i=0;i<n.length;i++){var o=n[i],c=new r.a.Query(a);c.get(o.id).then(function(a){a.addUnique("avatarHash",e),a.addUnique("assigneeId",t),a.save().then(function(){s.showIssue(),s.checked=[]})})}})}},watch:{}},c=o,l=(s("a00e"),s("2877")),u=Object(l["a"])(c,a,n,!1,null,"3d0f50f0",null),d=e["default"]=u.exports},a00e:function(t,e,s){"use strict";var a=s("bd62"),n=s.n(a);n.a},bd62:function(t,e,s){}}]);
//# sourceMappingURL=chunk-335fe83b.4a575a39.js.map