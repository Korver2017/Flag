(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cb559048"],{b906:function(e,t,s){"use strict";var a=s("c143"),n=s.n(a);n.a},bc84:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container my-4"},[s("h3",{staticClass:"my-5 text-left"},[s("router-link",{attrs:{to:{name:"organization"},tag:"a","active-class":"active"}},[s("a",[e._v(e._s(e.orgName))])]),e._v("\n     / \n    "),s("router-link",{attrs:{to:{name:"project"},tag:"a","active-class":"active"}},[s("a",[e._v(e._s(e.proName))])]),s("h1",{staticClass:"my-3"},[e._v(e._s(e.mileTitle))])],1),s("div",{staticClass:"row"},[s("div",{staticClass:"rwo text-left mb-5"},[s("button",{staticClass:"ml-3 btn btn-info",attrs:{type:"button"},on:{click:function(t){e.showOpened=!0}}},[e._v("\n        Open "),s("span",{staticClass:"badge badge-light"},[e._v(e._s(e.opened.length))])]),s("button",{staticClass:"ml-3 btn btn-secondary",attrs:{type:"button"},on:{click:function(t){e.showOpened=!1}}},[e._v("\n        Closed "),s("span",{staticClass:"badge badge-light"},[e._v(e._s(e.closed.length))])])]),s("div",{staticClass:"dropdown ml-auto mr-3 mb-3"},[s("button",{staticClass:"btn btn-secondary dropdown-toggle",attrs:{disabled:!1===e.checking,type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[e._v("\n        Mark as\n      ")]),s("div",{staticClass:"dropdown-menu",attrs:{"aria-labelledby":"dropdownMenuButton"}},[s("button",{staticClass:"dropdown-item",on:{click:e.reopenIssue}},[e._v("Open")]),s("button",{staticClass:"dropdown-item",on:{click:e.closeIssue}},[e._v("Closed")])])]),s("div",{staticClass:"dropdown mr-3"},[s("button",{staticClass:"btn btn-secondary dropdown-toggle",attrs:{disabled:!1===e.checking,type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[e._v("\n        加入到 Milestone\n      ")]),s("div",{staticClass:"dropdown-menu",attrs:{"aria-labelledby":"dropdownMenuButton"}},e._l(e.milestones,function(t,a){return s("button",{staticClass:"dropdown-item",on:{click:function(s){e.addIssueTo(t.mileId)}}},[e._v("\n\n          "+e._s(t.title)+"\n\n          "),e.mileId===t.mileId?[s("i",{staticClass:"ml-2 fa fa-check",attrs:{"aria-hidden":"true"}})]:e._e()],2)}),0)]),s("div",{staticClass:"dropdown mr-3"},[s("button",{staticClass:"btn btn-secondary dropdown-toggle",attrs:{disabled:!1===e.checking,type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[e._v("\n        Assign to\n      ")]),s("div",{staticClass:"dropdown-menu",attrs:{"aria-labelledby":"dropdownMenuButton"}},e._l(e.users,function(t,a){return s("button",{staticClass:"dropdown-item",on:{click:function(s){e.assignTo(t.assigneeId,t.avatarHash)}}},[e._v("\n\n          "+e._s(t.name)+"\n          ")])}),0)])]),s("h3",{staticClass:"text-left"},[e._v(e._s(e.percentage)+"% Complete")]),s("div",{staticClass:"progress"},[s("div",{staticClass:"progress-bar bg-success",style:{width:e.percentage+"%"},attrs:{role:"progressbar","aria-valuemin":"0","aria-valuemax":"100"}})]),e.issues.length>=1?s("div",{staticClass:"mt-5 list-group"},[e._l(e.issues,function(t){return!0===t.issueOpened&&!0===e.showOpened?s("li",{staticClass:"clearfix text-left list-group-item list-group-item-action",staticStyle:{"line-height":"50px"},attrs:{tag:"li",type:"li","active-class":"active"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.checked,expression:"checked"}],staticClass:"mr-3",attrs:{type:"checkbox"},domProps:{value:{issueId:t.issueId,assigneeId:t.assigneeId},checked:Array.isArray(e.checked)?e._i(e.checked,{issueId:t.issueId,assigneeId:t.assigneeId})>-1:e.checked},on:{change:function(s){var a=e.checked,n=s.target,i=!!n.checked;if(Array.isArray(a)){var o={issueId:t.issueId,assigneeId:t.assigneeId},r=e._i(a,o);n.checked?r<0&&(e.checked=a.concat([o])):r>-1&&(e.checked=a.slice(0,r).concat(a.slice(r+1)))}else e.checked=i}}}),s("router-link",{attrs:{to:{name:"issue",params:{issueId:t.issueId}},tag:"a","active-class":"active"}},[s("a",[e._v(e._s(t.name))])]),e._l(t.labels,function(t){return s("span",{staticClass:"py-2 px-3 ml-3 badge badge-primary"},[e._v(e._s(t))])}),e._l(t.avatarHash,function(a){return t.avatarHash.length>0?[s("img",{staticClass:"ml-3 float-right rounded",staticStyle:{width:"50px"},attrs:{src:"https://www.gravatar.com/avatar/"+a,alt:""}})]:e._e()})],2):e._e()}),e._l(e.issues,function(t){return!1===t.issueOpened&&!1===e.showOpened?s("li",{staticClass:"clearfix text-left list-group-item list-group-item-action",staticStyle:{"line-height":"50px"},attrs:{tag:"li",type:"li","active-class":"active"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.checked,expression:"checked"}],staticClass:"mr-3",attrs:{type:"checkbox"},domProps:{value:{issueId:t.issueId,assigneeId:t.assigneeId},checked:Array.isArray(e.checked)?e._i(e.checked,{issueId:t.issueId,assigneeId:t.assigneeId})>-1:e.checked},on:{change:function(s){var a=e.checked,n=s.target,i=!!n.checked;if(Array.isArray(a)){var o={issueId:t.issueId,assigneeId:t.assigneeId},r=e._i(a,o);n.checked?r<0&&(e.checked=a.concat([o])):r>-1&&(e.checked=a.slice(0,r).concat(a.slice(r+1)))}else e.checked=i}}}),s("router-link",{attrs:{to:{name:"issue",params:{issueId:t.issueId}},tag:"a","active-class":"active"}},[s("a",[e._v(e._s(t.name))])]),e._l(t.labels,function(t){return s("span",{staticClass:"py-2 px-3 ml-3 badge badge-primary"},[e._v(e._s(t))])}),e._l(t.avatarHash,function(a){return t.avatarHash.length>0?[s("img",{staticClass:"ml-3 float-right rounded",staticStyle:{width:"50px"},attrs:{src:"https://www.gravatar.com/avatar/"+a,alt:""}})]:e._e()})],2):e._e()})],2):e._e()])},n=[],i=(s("7514"),s("bf48")),o=s.n(i),r={name:"milestone-detail",components:{},data:function(){return{proName:"",issues:[],username:this.$store.state.user.username,checked:[],opened:[],closed:[],showOpened:!0,milestones:[],users:[],orgName:"",orgId:"",percentage:0}},computed:{mileId:function(){return this.$route.params.mileId},mileTitle:function(){return this.$route.params.mileTitle},proId:function(){return this.$route.params.proId},userId:function(){return this.$store.state.user.input.userId},checking:function(){var e=this;if(0===e.checked.length)return!1}},mounted:function(){var e=this;e.showUser(),e.showProName(),e.showIssue(),e.showMilestone()},methods:{showIssue:function(){var e=this,t=[],s=o.a.Object.extend("Issue"),a=new o.a.Query(s);a.equalTo("milestone",e.mileId),a.find().then(function(s){e.opened=[],e.closed=[];for(var a=function(a){var n={},i=s[a];n.name=i.get("name"),n.issueId=i.id,n.avatarHash=i.get("avatarHash"),n.assigneeId=i.get("assigneeId");var r=[],c=o.a.Object.extend("Label"),d=new o.a.Query(c);d.equalTo("issueId",i.id),d.find().then(function(e){for(var t=0;t<e.length;t++){var s=e[t];r.push(s.get("title"))}}),n.labels=r,n.issueOpened=i.get("issueOpened"),!0===n.issueOpened?e.opened.push(i.id):e.closed.push(i.id),t.push(n)},n=0;n<s.length;n++)a(n)}).then(function(t){var s=e.closed.length,a=e.opened.length;e.percentage=a+s===0?0:(s/(a+s)*100).toFixed(0)}),e.issues=t},showUser:function(){var e=this,t=o.a.Object.extend("Project"),s=new o.a.Query(t),a=[];s.get(e.proId).then(function(t){var s=t.get("orgId"),n=o.a.Object.extend("Organization"),i=new o.a.Query(n);e.orgId=s,i.get(s).then(function(e){for(var t=e.get("memberId"),s=function(e){var s={},n=t[e],i=o.a.Object.extend("Account"),r=new o.a.Query(i);r.get(n).then(function(e){s.name=e.get("username"),s.assigneeId=n,s.avatarHash=e.get("avatarHash"),s.email=e.get("email"),a.push(s)})},n=0;n<t.length;n++)s(n)}),e.users=a},function(e){})},showProName:function(){var e=this,t=e.$route.params.proId,s=o.a.Object.extend("Project"),a=new o.a.Query(s);a.get(t).then(function(t){e.proName=t.get("name"),e.orgName=t.get("orgName")})},closeIssue:function(){for(var e=this,t=o.a.Object.extend("Issue"),s=0;s<e.checked.length;s++){var a=new o.a.Query(t);a.get(e.checked[s].issueId).then(function(t){t.set("issueOpened",!1),t.save().then(function(){e.showIssue()})},function(e){})}e.checked=[]},reopenIssue:function(){for(var e=this,t=o.a.Object.extend("Issue"),s=0;s<e.checked.length;s++){var a=new o.a.Query(t);a.get(e.checked[s].issueId).then(function(t){t.set("issueOpened",!0),t.save().then(function(){return e.showIssue()})},function(e){})}e.checked=[]},showMilestone:function(){var e=this,t=o.a.Object.extend("Milestone"),s=new o.a.Query(t),a=[];s.equalTo("proId",e.proId),s.find().then(function(e){for(var t=0;t<e.length;t++){var s={},n=e[t];s.mileId=n.id,s.title=n.get("title"),a.push(s)}}),e.milestones=a},addIssueTo:function(e){for(var t=this,s=o.a.Object.extend("Issue"),a=0;a<t.checked.length;a++){var n=new o.a.Query(s);n.get(t.checked[a].issueId).then(function(s){s.set("milestone",e),s.save().then(function(e){t.showIssue(),t.checked=[]});var a=o.a.Object.extend("Milestone"),n=new o.a.Query(a);n.get(e).then(function(e){return e.set("proId",t.proId),e.save()},function(e){})},function(e){})}},assignTo:function(e,t){var s=this,a=o.a.Object.extend("Issue"),n=new o.a.Query(a),i=s.checked.map(function(e){return e.issueId});n.containedIn("objectId",i),n.find().then(function(n){for(var i=0;i<n.length;i++){var r=n[i],c=new o.a.Query(a);c.get(r.id).then(function(a){a.addUnique("avatarHash",t),a.addUnique("assigneeId",e),a.save().then(function(){s.showIssue(),s.checked=[]})})}})},addMilestone:function(){var e=this,t=o.a.Object.extend("Milestone"),s=new t;s.set("title",e.mileTitle),s.set("proId",e.proId),s.set("orgId",e.orgId),s.set("mileOpened",!0),s.save().then(function(t){e.mileTitle="",e.showMilestone()},function(e){alert("Failed to create new object, with error code: "+e.message)})}},watch:{}},c=r,d=(s("b906"),s("2877")),u=Object(d["a"])(c,a,n,!1,null,"4e77fadc",null);t["default"]=u.exports},c143:function(e,t,s){}}]);
//# sourceMappingURL=chunk-cb559048.be06df5e.js.map