(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c14f9"],{4601:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.user.authed?[t.avatarHash.length>0?a("img",{staticClass:"rounded-circle mt-5",attrs:{src:"https://www.gravatar.com/avatar/"+t.avatarHash,alt:""}}):t._e(),a("h2",{staticClass:"nav-item nav-link align-right"},[t._v("Hi, "+t._s(t.username)+"!")]),a("h5",[t._v("Welcome to Flag")]),a("div",{staticClass:"container my-5"},[a("div",{staticClass:"row"},[0!==t.orgs.length?a("div",{staticClass:"col-8 mx-auto"},[a("h5",{staticClass:"text-left"},[t._v("My Organization")]),a("div",{staticClass:"row"},t._l(t.orgs,function(e){return a("router-link",{key:e.id,staticClass:"col-4 list-group-item list-group-item-action btn btn-success",attrs:{to:{name:"organization",params:{orgId:e.orgId}},tag:"button","active-class":"active"}},[t._v("\n              "+t._s(e.name)+"\n            ")])}),1)]):t._e(),a("form",{staticClass:"col-4 mx-auto"},[a("div",{staticClass:"form-group text-left"},[a("label",{attrs:{for:"name"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addOrganization(e)}}},[t._v("Add organization")]),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.orgName,expression:"orgName",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{placeholder:"Organization name",id:"name"},domProps:{value:t.orgName},on:{input:function(e){e.target.composing||(t.orgName=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),a("button",{staticClass:"mx-3 btn btn-success",on:{click:function(e){return e.preventDefault(),t.addOrganization(e)}}},[t._v("Add organization")])])])])]:t._e()],2)},r=[],s=(a("7514"),a("bf48")),i=a.n(s),o={name:"dashboard",components:{},data:function(){return{username:"",orgName:"",orgs:[],avatarHash:""}},created:function(){!1===this.$store.state.user.authed&&this.$router.push({path:"/signin"})},computed:{user:function(){return{authed:this.$store.state.user.authed,email:this.$store.state.user.input.email,id:this.$store.state.user.input.userId}}},mounted:function(){this.showOrg(),this.showUsername()},methods:{showOrg:function(){var t=this,e=i.a.Object.extend("Organization"),a=new i.a.Query(e),n=[];a.equalTo("memberId",t.user.id),a.find().then(function(a){for(var r=function(t){var r={},s=a[t],o=new i.a.Query(e);r.orgId=s.id,o.get(s.id).then(function(t){r.name=t.get("name"),n.push(r)})},s=0;s<a.length;s++)r(s);t.orgs=n})},showUsername:function(){var t=this,e=i.a.Object.extend("Account"),a=new i.a.Query(e);a.get(t.user.id).then(function(e){t.avatarHash=t.$md5(e.get("email")),t.username=e.get("username")})},logOut:function(){var t=this;t.$store.dispatch("user/logOut"),t.$router.push({path:"/signin"})},addOrganization:function(){var t=this;if(""!==t.orgName){var e=i.a.Object.extend("Organization"),a=new e;a.set("name",t.orgName),a.set("memberId",[t.$store.state.user.input.userId]),a.save().then(function(e){t.orgName="",t.showOrg()},function(t){alert("Failed to create new object, with error code: "+t.message)})}else alert("組織名稱不可空白")}},watch:{user:function(){this.showOrg(),this.showUsername()}}},u=o,c=a("2877"),d=Object(c["a"])(u,n,r,!1,null,"24f22dc4",null);e["default"]=d.exports}}]);
//# sourceMappingURL=chunk-2d0c14f9.07c068f7.js.map