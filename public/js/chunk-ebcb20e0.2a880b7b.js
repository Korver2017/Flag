(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ebcb20e0"],{"212a":function(t,e,a){},bc84:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"my-3",attrs:{id:"wrap"}},[a("h3",[t._v(t._s(t.mileId))]),a("div",{staticClass:"row my-4"},[a("div",{staticClass:"mb-0 d-flex align-items-center"},[a("h4",{staticClass:"text-left"},[a("router-link",{attrs:{to:{name:"organization"},tag:"a","active-class":"active"}},[a("a",[t._v(t._s(t.orgName))])]),t._v("\r\n            / "),a("router-link",{attrs:{to:{name:"project"},tag:"a","active-class":"active"}},[a("a",[t._v(t._s(t.proName))])])],1)]),t._m(0)]),a("ul",{staticClass:"nav nav-tabs"},[t._m(1),a("router-link",{staticClass:"nav-item",attrs:{to:{name:"project",params:{orgId:t.orgId,proId:t.proId}},tag:"li","active-class":"active"}},[a("a",{staticClass:"nav-link active"},[t._v("問題 "),a("span",{staticClass:"ml-2 badge badge-secondary"},[t._v("123")])])]),t._m(2),t._m(3),t._m(4),t._m(5),t._m(6)],1),a("div",{staticClass:"row my-4 d-flex justify-content-between"},[a("h4",[t._v(t._s(t.mileTitle))]),a("router-link",{staticClass:"ml-auto mr-2 btn btn-secondary",attrs:{to:{name:"milestone-detail"},tag:"button","active-class":"active"}},[t._v("\r\n          編輯里程碑\r\n        ")]),a("router-link",{staticClass:"btn btn-success",attrs:{to:{name:"milestone-detail"},tag:"button","active-class":"active"}},[t._v("\r\n          建立問題\r\n        ")])],1),a("div",{staticClass:"row mt-3"},[a("h5",[t._v(t._s(t.percentage)+"% Completed")])]),a("hr"),a("div",{staticClass:"row"},[a("div",{staticClass:"btn-group",attrs:{role:"group","aria-label":"Basic example"}},[a("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button"},on:{click:function(e){t.showOpened=!0}}},[t._v("\r\n            "+t._s(t.opened.length)+" 個開啟中\r\n          ")]),a("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button"},on:{click:function(e){t.showOpened=!1}}},[t._v("\r\n            "+t._s(t.closed.length)+" 個已關閉\r\n          ")])]),0===t.checked.length?a("div",{staticClass:"row ml-auto"},[t._m(7),t._m(8),t._m(9),t._m(10),t._m(11)]):a("div",{staticClass:"row ml-auto"},[a("div",{staticClass:"dropdown mx-3"},[a("button",{staticClass:"btn btn-outline-danger",on:{click:t.closeIssue}},[t._v("\r\n          關閉\r\n        ")])]),a("div",{staticClass:"dropdown mx-3"},[a("button",{staticClass:"btn btn-outline-white dropdown-toggle",attrs:{type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[t._v("\r\n          標籤\r\n        ")]),a("div",{staticClass:"dropdown-menu",attrs:{"aria-labelledby":"dropdownMenuButton"}},t._l(t.labels,function(e){return a("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(a){t.addLabelTo(e.labelId)}}},[t._v(t._s(e.title))])}),0)]),a("div",{staticClass:"dropdown mx-3"},[a("button",{staticClass:"btn btn-outline-white dropdown-toggle",attrs:{type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[t._v("\r\n          負責人\r\n        ")]),a("div",{staticClass:"dropdown-menu",attrs:{"aria-labelledby":"dropdownMenuButton"}},t._l(t.users,function(e){return a("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(a){t.assignTo(e.assigneeId,e.avatarHash)}}},[t._v(t._s(e.name))])}),0)])])]),t.issues.length>=1?a("ul",{staticClass:"mt-5 list-group list-group-flush"},[t._l(t.issues,function(e){return!0===e.issueOpened&&!0===t.showOpened?a("li",{staticClass:"d-flex align-items-center list-group-item text-left",attrs:{s:"",tag:"li",type:"li","active-class":"active"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.checked,expression:"checked"}],staticClass:"mr-3",attrs:{type:"checkbox"},domProps:{value:{issueId:e.issueId,assigneeId:e.assigneeId},checked:Array.isArray(t.checked)?t._i(t.checked,{issueId:e.issueId,assigneeId:e.assigneeId})>-1:t.checked},on:{change:function(a){var s=t.checked,n=a.target,i=!!n.checked;if(Array.isArray(s)){var r={issueId:e.issueId,assigneeId:e.assigneeId},o=t._i(s,r);n.checked?o<0&&(t.checked=s.concat([r])):o>-1&&(t.checked=s.slice(0,o).concat(s.slice(o+1)))}else t.checked=i}}}),a("router-link",{attrs:{to:{name:"issue",params:{issueId:e.issueId}},tag:"a","active-class":"active"}},[a("a",[t._v(t._s(e.name))])]),t._l(e.labels,function(e){return a("span",{staticClass:"py-2 px-3 ml-3 badge badge-primary"},[t._v(t._s(e))])}),t._l(e.avatarHash,function(s){return e.avatarHash.length>0?[a("img",{staticClass:"ml-auto float-right rounded",staticStyle:{width:"50px"},attrs:{src:"https://www.gravatar.com/avatar/"+s,alt:""}})]:t._e()})],2):t._e()}),t._l(t.issues,function(e){return!1===e.issueOpened&&!1===t.showOpened?a("li",{staticClass:"clearfix text-left list-group-item list-group-item-action",staticStyle:{"line-height":"50px"},attrs:{tag:"li",type:"li","active-class":"active"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.checked,expression:"checked"}],staticClass:"mr-3",attrs:{type:"checkbox"},domProps:{value:{issueId:e.issueId,assigneeId:e.assigneeId},checked:Array.isArray(t.checked)?t._i(t.checked,{issueId:e.issueId,assigneeId:e.assigneeId})>-1:t.checked},on:{change:function(a){var s=t.checked,n=a.target,i=!!n.checked;if(Array.isArray(s)){var r={issueId:e.issueId,assigneeId:e.assigneeId},o=t._i(s,r);n.checked?o<0&&(t.checked=s.concat([r])):o>-1&&(t.checked=s.slice(0,o).concat(s.slice(o+1)))}else t.checked=i}}}),a("router-link",{attrs:{to:{name:"issue",params:{issueId:e.issueId}},tag:"a","active-class":"active"}},[a("a",[t._v(t._s(e.name))])]),t._l(e.labels,function(e){return a("span",{staticClass:"py-2 px-3 ml-3 badge badge-primary"},[t._v(t._s(e))])}),t._l(e.avatarHash,function(s){return e.avatarHash.length>0?[a("img",{staticClass:"ml-3 float-right rounded",staticStyle:{width:"50px"},attrs:{src:"https://www.gravatar.com/avatar/"+s,alt:""}})]:t._e()})],2):t._e()})],2):t._e()])])},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ml-auto"},[a("div",{staticClass:"pr-3 btn-group btn-group-toggle",attrs:{"data-toggle":"buttons"}},[a("label",{staticClass:"border border-dark btn"},[a("input",{attrs:{type:"radio",name:"options",id:"option1",autocomplete:"off",checked:""}}),t._v(" 取消關注\r\n            ")]),a("label",{staticClass:"border border-dark btn"},[a("input",{attrs:{type:"radio",name:"options",id:"option2",autocomplete:"off"}}),t._v(" 8\r\n            ")])]),a("div",{staticClass:"pr-3 btn-group btn-group-toggle",attrs:{"data-toggle":"buttons"}},[a("label",{staticClass:"border border-dark btn"},[a("input",{attrs:{type:"radio",name:"options",id:"option1",autocomplete:"off",checked:""}}),t._v(" 收藏\r\n            ")]),a("label",{staticClass:"border border-dark btn"},[a("input",{attrs:{type:"radio",name:"options",id:"option2",autocomplete:"off"}}),t._v(" 0\r\n            ")])]),a("div",{staticClass:"pr-3 btn-group btn-group-toggle",attrs:{"data-toggle":"buttons"}},[a("label",{staticClass:"border border-dark btn"},[a("input",{attrs:{type:"radio",name:"options",id:"option1",autocomplete:"off",checked:""}}),t._v(" 複製\r\n            ")]),a("label",{staticClass:"border border-dark btn"},[a("input",{attrs:{type:"radio",name:"options",id:"option2",autocomplete:"off"}}),t._v(" 0\r\n            ")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link",attrs:{href:"#"}},[t._v("程式碼")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link",attrs:{href:"#"}},[t._v("合併請求"),a("span",{staticClass:"ml-2 badge badge-secondary"},[t._v("0")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link",attrs:{href:"#"}},[t._v("版本發佈"),a("span",{staticClass:"ml-2 badge badge-secondary"},[t._v("0")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link",attrs:{href:"#"}},[t._v("Wiki")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link",attrs:{href:"#"}},[t._v("活動")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"ml-auto nav-item"},[a("a",{staticClass:"nav-link",attrs:{href:"#"}},[t._v("儲存庫設定")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dropdown mx-3"},[a("button",{staticClass:"btn btn-outline-white dropdown-toggle",attrs:{type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[t._v("\r\n          標籤篩選\r\n        ")]),a("div",{staticClass:"dropdown-menu",attrs:{"aria-labelledby":"dropdownMenuButton"}},[a("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Action")]),a("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Another action")]),a("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Something else here")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dropdown mx-3"},[a("button",{staticClass:"btn btn-outline-white dropdown-toggle",attrs:{type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[t._v("\r\n          里程碑篩選\r\n        ")]),a("div",{staticClass:"dropdown-menu",attrs:{"aria-labelledby":"dropdownMenuButton"}},[a("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Action")]),a("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Another action")]),a("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Something else here")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dropdown mx-3"},[a("button",{staticClass:"btn btn-outline-white dropdown-toggle",attrs:{type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[t._v("\r\n          指派人篩選\r\n        ")]),a("div",{staticClass:"dropdown-menu",attrs:{"aria-labelledby":"dropdownMenuButton"}},[a("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Action")]),a("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Another action")]),a("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Something else here")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dropdown mx-3"},[a("button",{staticClass:"btn btn-outline-white dropdown-toggle",attrs:{type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[t._v("\r\n          類型篩選\r\n        ")]),a("div",{staticClass:"dropdown-menu",attrs:{"aria-labelledby":"dropdownMenuButton"}},[a("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Action")]),a("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Another action")]),a("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Something else here")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dropdown mx-3"},[a("button",{staticClass:"btn btn-outline-white dropdown-toggle",attrs:{type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[t._v("\r\n          順序\r\n        ")]),a("div",{staticClass:"dropdown-menu",attrs:{"aria-labelledby":"dropdownMenuButton"}},[a("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Action")]),a("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Another action")]),a("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Something else here")])])])}],i=(a("7514"),a("bf48")),r=a.n(i),o={name:"milestone-detail",components:{},data:function(){return{proName:"",issues:[],username:this.$store.state.user.username,checked:[],opened:[],closed:[],showOpened:!0,milestones:[],users:[],orgName:"",orgId:"",percentage:0,labels:[]}},computed:{mileId:function(){return this.$route.params.mileId},mileTitle:function(){return this.$route.params.mileTitle},proId:function(){return this.$route.params.proId},userId:function(){return this.$store.state.user.input.userId},checking:function(){var t=this;if(0===t.checked.length)return!1}},mounted:function(){var t=this;t.showUser(),t.showProName(),t.showIssue(),t.showMilestone(),t.showLabel()},methods:{addLabelTo:function(t){var e=this,a=r.a.Object.extend("Label"),s=new r.a.Query(a);s.get(t).then(function(t){for(var a=0;a<e.checked.length;a++)t.addUnique("issueId",e.checked[a].issueId);t.save().then(function(t){e.showIssue()})},function(t){})},showLabel:function(){var t=this,e=r.a.Object.extend("Label"),a=new r.a.Query(e),s=[];a.equalTo("proId",t.proId),a.find().then(function(t){for(var e=0;e<t.length;e++){var a={},n=t[e];a.labelId=n.id,a.title=n.get("title"),a.labelDesc=n.get("labelDesc"),a.issueId=n.get("issueId"),s.push(a)}},function(t){}),t.labels=s},showIssue:function(){var t=this,e=[],a=r.a.Object.extend("Issue"),s=new r.a.Query(a);s.equalTo("milestone",t.mileId),s.find().then(function(a){t.opened=[],t.closed=[];for(var s=function(s){var n={},i=a[s];n.name=i.get("name"),n.issueId=i.id,n.avatarHash=i.get("avatarHash"),n.assigneeId=i.get("assigneeId");var o=[],d=r.a.Object.extend("Label"),c=new r.a.Query(d);c.equalTo("issueId",i.id),c.find().then(function(t){for(var e=0;e<t.length;e++){var a=t[e];o.push(a.get("title"))}}),n.labels=o,n.issueOpened=i.get("issueOpened"),!0===n.issueOpened?t.opened.push(i.id):t.closed.push(i.id),e.push(n)},n=0;n<a.length;n++)s(n)}).then(function(e){var a=t.closed.length,s=t.opened.length;t.percentage=s+a===0?0:(a/(s+a)*100).toFixed(0)}),t.issues=e},showUser:function(){var t=this,e=r.a.Object.extend("Project"),a=new r.a.Query(e),s=[];a.get(t.proId).then(function(e){var a=e.get("orgId"),n=r.a.Object.extend("Organization"),i=new r.a.Query(n);t.orgId=a,i.get(a).then(function(t){for(var e=t.get("memberId"),a=function(t){var a={},n=e[t],i=r.a.Object.extend("Account"),o=new r.a.Query(i);o.get(n).then(function(t){a.name=t.get("username"),a.assigneeId=n,a.avatarHash=t.get("avatarHash"),a.email=t.get("email"),s.push(a)})},n=0;n<e.length;n++)a(n)}),t.users=s},function(t){})},showProName:function(){var t=this,e=t.$route.params.proId,a=r.a.Object.extend("Project"),s=new r.a.Query(a);s.get(e).then(function(e){t.proName=e.get("name"),t.orgName=e.get("orgName")})},closeIssue:function(){for(var t=this,e=r.a.Object.extend("Issue"),a=0;a<t.checked.length;a++){var s=new r.a.Query(e);s.get(t.checked[a].issueId).then(function(e){e.set("issueOpened",!1),e.save().then(function(){t.showIssue()})},function(t){})}t.checked=[]},reopenIssue:function(){for(var t=this,e=r.a.Object.extend("Issue"),a=0;a<t.checked.length;a++){var s=new r.a.Query(e);s.get(t.checked[a].issueId).then(function(e){e.set("issueOpened",!0),e.save().then(function(){return t.showIssue()})},function(t){})}t.checked=[]},showMilestone:function(){var t=this,e=r.a.Object.extend("Milestone"),a=new r.a.Query(e),s=[];a.equalTo("proId",t.proId),a.find().then(function(t){for(var e=0;e<t.length;e++){var a={},n=t[e];a.mileId=n.id,a.title=n.get("title"),s.push(a)}}),t.milestones=s},addIssueTo:function(t){for(var e=this,a=r.a.Object.extend("Issue"),s=0;s<e.checked.length;s++){var n=new r.a.Query(a);n.get(e.checked[s].issueId).then(function(a){a.set("milestone",t),a.save().then(function(t){e.showIssue(),e.checked=[]});var s=r.a.Object.extend("Milestone"),n=new r.a.Query(s);n.get(t).then(function(t){return t.set("proId",e.proId),t.save()},function(t){})},function(t){})}},assignTo:function(t,e){var a=this,s=r.a.Object.extend("Issue"),n=new r.a.Query(s),i=a.checked.map(function(t){return t.issueId});n.containedIn("objectId",i),n.find().then(function(n){for(var i=0;i<n.length;i++){var o=n[i],d=new r.a.Query(s);d.get(o.id).then(function(s){s.addUnique("avatarHash",e),s.addUnique("assigneeId",t),s.save().then(function(){a.showIssue(),a.checked=[]})})}})},addMilestone:function(){var t=this,e=r.a.Object.extend("Milestone"),a=new e;a.set("title",t.mileTitle),a.set("proId",t.proId),a.set("orgId",t.orgId),a.set("mileOpened",!0),a.save().then(function(e){t.mileTitle="",t.showMilestone()},function(t){alert("Failed to create new object, with error code: "+t.message)})}},watch:{}},d=o,c=(a("f781"),a("2877")),l=Object(c["a"])(d,s,n,!1,null,"787e98c3",null);e["default"]=l.exports},f781:function(t,e,a){"use strict";var s=a("212a"),n=a.n(s);n.a}}]);
//# sourceMappingURL=chunk-ebcb20e0.2a880b7b.js.map